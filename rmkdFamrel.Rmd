---
title: "rmkdFamRel"
author: "Clément Malidor"
date: "5/12/2021"
output: html_document
---

Importons ici toutes les libraries utiles à notre projet
```{r setup, include=FALSE}
library(readr)
library(ggplot2)
library(dplyr)
library(scales)
library("gridExtra")
```

Importons dans un premier temps les datasets

```{r importDS}
dfMaths <- read_csv("data/student-mat.csv")
dfMaths <- dfMaths %>% filter(age < 20)

#ajout d'une colonne de moyenne des 3 notes :
temp <- dfMaths %>% select(G1,G2,G3)
temp <- as.data.frame(rowSums(temp)/3)
dfMaths <- cbind(dfMaths, temp) %>% rename('Gmean' = `rowSums(temp)/3`)

#Visualisation du dataset
head(dfMaths)

dfPortugais <- read_csv("data/student-por.csv")
dfPortugais <- dfPortugais

#ajout d'une colonne de moyenne des 3 notes :
temp <- dfPortugais %>% select(G1,G2,G3)
temp <- as.data.frame(rowSums(temp)/3)
dfPortugais <- cbind(dfPortugais, temp) %>% rename('Gmean' = `rowSums(temp)/3`)
head(dfPortugais)
```

# Qu'est ce qui fait varier les relations familiales

```{r cal_moyenne_famrel}
total_famrel <- dfPortugais$famrel
mean_famrel <- round(mean(total_famrel), digits=2)
mean_famrel
```

La moyenne des relations familiales est de **`r mean_famrel`**.

```{r famrel}
ggplot(dfPortugais, aes(x = famrel)) + 
    geom_bar()+
    scale_fill_brewer(palette = "Dark2") + 
    labs(x = "Relations familiales" ,title = "Répartitions des relations familiales")

```


## Regardons si le sexe fait varier les relations familiales

```{r cal_moyenne_famrel_sex}
total_famrel_M <- dfPortugais %>%
  select(famrel, sex) %>%
  filter(sex == 'M')
total_famrel_M <- total_famrel_M$famrel
mean_famrel_M <- round(mean(total_famrel_M), digits=2)
mean_famrel_M

total_famrel_F <- dfPortugais %>%
  select(famrel, sex) %>%
  filter(sex == 'F')
total_famrel_F <- total_famrel_F$famrel
mean_famrel_F <- round(mean(total_famrel_F), digits=2)
mean_famrel_F
```

La moyenne des relations familiales chez les garçons est de  **`r mean_famrel_M`** 
tandis que chez les filles elle est de **`r mean_famrel_F`**.

```{r sex_famrel}
df <- dfMaths %>% select(sex, famrel)

dfP <- ggplot(df, aes(x = sex, y = famrel)) + 
  geom_boxplot(aes(fill = sex),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du genre (mat)")

df <- dfPortugais %>% select(sex, famrel)

dfM <- ggplot(df, aes(x = sex, y = famrel)) + 
  geom_boxplot(aes(fill = sex),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du genre (por)")

grid.arrange(dfP, dfM, ncol=2, nrow = 1)
```

**A REVOIR LA CONCLUSION**

## Regardons si l'adresse fait varier les relations familiales
```{r address_famrel}
df <- dfMaths %>% select(address, famrel)

ggplot(df, aes(x = address, y = famrel)) + 
  geom_violin(aes(fill = address),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction de l'adresse (mat)")
```

**Conclusion : l'adresse ne fait pas varier les relations familiales**

## Regardons si le tuteur légal fait varier les relations familiales
```{r guardian_famrel}
df <- dfMaths %>% select(guardian, famrel)

ggplot(df, aes(x = guardian, y = famrel)) + 
  geom_boxplot(aes(fill = guardian),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du tutueur légal (mat)")

df <- dfPortugais %>% select(guardian, famrel)

ggplot(df, aes(x = guardian, y = famrel)) + 
  geom_boxplot(aes(fill = guardian),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du tutueur légal (por)")
```

**Conclusion : **

## Regardons si le soutient scolaire familial fait varier les relations familiales
```{r famsup_famrel}
df <- dfMaths %>% select(famsup, famrel)

ggplot(df, aes(x = famsup, y = famrel)) + 
  geom_boxplot(aes(fill = famsup),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du soutient familial (mat)")

df <- dfPortugais %>% select(famsup, famrel)

ggplot(df, aes(x = famsup, y = famrel)) + 
  geom_boxplot(aes(fill = famsup),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du soutient familial (por)")
```

## Regardons si le travail des parents fait varier les relations familiales
```{r Pjob_famrel}
df <- dfMaths %>% select(Mjob, famrel)

ggplot(df, aes(x = Mjob, y = famrel)) + 
  geom_boxplot(aes(fill = Mjob),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du soutient familial (mat)")

df <- dfPortugais %>% select(Mjob, famrel)

ggplot(df, aes(x = Mjob, y = famrel)) + 
  geom_boxplot(aes(fill = Mjob),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Relations familiales en fonction du soutient familial (por)")
```

**Conclusion : **


## Regardons si l'éducation des parents fait varier les relations familiales
```{r Pedu_famrel}
#preparation des données
df <- dfMaths %>% group_by(Fedu) %>% mutate(mean_famrel = mean(famrel)) %>% distinct(Fedu, mean_famrel)

ggplot(df, aes(x = Fedu, y = mean_famrel)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = Fedu)) +
    labs(title = "Relations familiales pour selon l'éducation du père", x = "Education père", y = "moyenne des relations familiales", fill = "Education du père") +
    scale_fill_continuous(labels = c("0 : Aucune", "1 : Primaire", "2 : Collège", "3 : Lycée", "4 : Suppérieur"), type = "viridis")

df <- dfPortugais %>% group_by(Medu) %>% mutate(mean_famrel = mean(famrel)) %>% distinct(Medu, mean_famrel)

ggplot(df, aes(x = Medu, y = mean_famrel)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = Medu)) +
    labs(title = "Relations familiales pour selon l'éducation de la mère", x = "Education mère", y = "moyenne des relations familiales", fill = "Education de la mère") +
    scale_fill_continuous(labels = c("0 : Aucune", "1 : Primaire", "2 : Collège", "3 : Lycée", "4 : Suppérieur"), type = "viridis")

df <- dfMaths %>% group_by(Medu) %>% mutate(mean_famrel = mean(famrel)) %>% distinct(Medu, mean_famrel)

ggplot(df, aes(x = Medu, y = mean_famrel)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = Medu)) +
    labs(title = "Relations familiales pour selon l'éducation de la mère", x = "Education mère", y = "moyenne des relations familiales", fill = "Education de la mère") +
    scale_fill_continuous(labels = c("0 : Aucune", "1 : Primaire", "2 : Collège", "3 : Lycée", "4 : Suppérieur"), type = "viridis")
```

# VOIR POUR PASSER LES INT EN CHAR

**Conclusion** : Avoir des parents étant allé au moins en primaire permet d'avoir des supers relations familiales.
