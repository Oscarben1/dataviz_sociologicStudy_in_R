---
title: "rmkdAlbertSante"
author: "Albert ELOMBO"
date: "19/05/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

Dans cette paertie du projet on va s'interesser à la santé des élèves. Dans un premier temps à la santé physique, puis à la santé mentale.
Considérant que le dataset nous donne des informations sur contexte social, économique et culturel des famlles ainsi que sur le sexe, nous allons essayer de trouver des correlations entre l'état de santé des élèves ainsi que ces critères.

#Exploration du dataset

## Variables à priori signifiatives sur la santé

* Pstatus, guardian, studytime, freetime, goout, Dalc, Walc romantic pour la santé mentale
* Medu, Fedu, Mjob, Fjob, Famrel pour le contexte
* Health comme indicateur de significativité

## Santé exploration


```{r}
# On charge les libraries

library(dplyr)
library(ggplot2)

#On charge les datasets
dfMat <- as_tibble(read.csv("data/student-mat.csv"))
dfPor <- as_tibble(read.csv("data/student-por.csv"))

```


### Etat de santé général
Distribution de l'état de santé
```{r}
plotMat <- ggplot(dfMat, aes( x = health, fill = sex)) + 
  geom_bar() + 
  labs(title = "répartition de l'état de santé", x = "état de santé", y = "effectif")

plotPor <- ggplot(dfPor, aes( x = health, fill = sex)) + 
  geom_bar() +
  labs(title = "répartition de l'état de santé", x = "état de santé", y = "effectif")
        

plotMat
plotPor
```

Etat de santé en fonction de la relation familiale

```{r}
dataMat <- dfMat %>% select(health, famrel)

dataMat <- dataMat %>% group_by(famrel) %>% summarise_all(mean)

plotMat <- dataMat %>% ggplot( aes(x = famrel, y = health)) +
  geom_col(aes( fill = famrel)) + 
  labs( title = "État de santé en fonction de la relation familliale",
        x = "Relation familiale", y = "État de santé / 5")

dataPor <- dfMat %>% select(health, famrel)

dataPor <- dataMat %>% group_by(famrel) %>% summarise_all(mean)

plotPor <- dataMat %>% ggplot( aes(x = famrel, y = health)) +
  geom_col(aes( fill = famrel)) +
  labs( title = "État de santé en fonction de la relation familliale",
        x = "Relation familiale", y = "État de santé / 5") 
plotMat
plotPor
```

Relation familiale en fonction du sexe

```{r}
dataMat <- dfMat %>% select(sex, famrel) %>%
  group_by(sex) %>%
  summarise_all(mean)

head(dataMat)

plotMat <- ggplot(dataMat, aes(x = sex, y = famrel)) +
  geom_col(aes(fill = famrel)) + 
  labs( title = "Relation familiale moyenne selon le sexe", x = "sexe", y = "relation familiale")

plotMat
```



Etat de santé en fonction de la consommation d'alcool

* En week-end

```{r}
dataMat <- dfMat %>% select(health, Walc)

dataMat <- dataMat %>% group_by(Walc) %>% summarise_all(mean)

plotMat <- dataMat %>% ggplot( aes(x = Walc, y = health)) +
  geom_col(aes( fill = Walc)) + 
  labs( title = "État de santé en fonction de la consomation d'alcool le week-end",
        x = "consomation d'alcool / 5", y = "État de santé / 5")

plotMat
```

* En semaine
```{r}
dataMat <- dfMat %>% select(health, Dalc)

dataMat <- dataMat %>% group_by(Dalc) %>% summarise_all(mean)

plotMat <- dataMat %>% ggplot( aes(x = Dalc, y = health)) +
  geom_col(aes( fill = Dalc)) + 
  labs( title = "État de santé en fonction de la consomation d'alcool le week-end",
        x = "consomation d'alcool / 5", y = "État de santé / 5")

plotMat
```

* La moyenne des deux



```{r}
dataMat <- dfMat %>% transmute(health, alc = (Dalc + Walc)/2)
dataMat <- dataMat %>% group_by(alc) %>% summarise_all(mean)
head (dataMat)

plotMat <- dataMat %>% ggplot( aes(x = factor (alc), y = health)) +
  geom_col(aes( fill = health)) + 
  labs( title = "État de santé en fonction de la consomation d'alcool en général",
        x = "consomation d'alcool / 5", y = "État de santé / 5")

plotMat
```

Consomation d'alcool en fonction du sexe

```{r}
dataMat <- dfMat %>% transmute(sex, alc = (Dalc + Walc)/2)
dataMat <- dataMat %>% group_by(sex) %>% summarise_all(mean)
head (dataMat)

plotMat <- dataMat %>% ggplot( aes(x = sex, y = alc)) +
  geom_col(aes( fill = sex)) +
  labs( title = "consommation moyenne d'alcool selon le sexe ", x = "sexe", y = "consommation d'alcool")

plotMat
```

Répartition de la consommation d'alcool chez les garçons

* En moyenne

```{r}
dataMat <- dfMat %>%
  transmute(sex, alc = (Dalc + Walc)/2)


plotMat <- ggplot(dataMat, aes(x  = factor(alc), fill = sex)) + 
  geom_bar(position = "dodge") 

plotMat
```

* En week-end

```{r}
dataMat <- dfMat %>% select(sex, Walc)

plotMat <- ggplot(dataMat, aes(x  = factor(Walc), fill = sex)) + 
  geom_bar(position = "dodge") 

plotMat
```


* En semaine

```{r}
dataMat <- dfMat %>% select(sex, Dalc)

plotMat <- ggplot(dataMat, aes(x  = factor(Dalc), fill = sex)) + 
  geom_bar(position = "dodge") 

plotMat
```


Etat de santé en fonction de la vie amoureuse

```{r}
dataMat <- dfMat %>% select(health, romantic)

dataMat <- dataMat %>% group_by(romantic) %>% summarise_all(mean)

plotMat <- dataMat %>% ggplot( aes(x = factor(romantic), y = health)) +
  geom_col(aes( fill = romantic)) + 
  labs( title = "État de santé en fonction de la vie amoureuse",
        x = "En couple", y = "État de santé / 5")

plotMat
```

Etat de santé en fonction du tuteur

```{r}
dataMat <- dfMat %>% select(guardian, health) %>%
  group_by(guardian) %>%
  summarise_all(mean)

plotMat <- ggplot(dataMat, aes(x = factor(guardian), y = health, fill = guardian )) + 
  geom_col() +
  labs( title = "Etat de santé en fonction du tuteur")

plotMat
```

Etat de santé en fonction du tuteur pour les familles séparées

```{r}
dataMat <- dfMat %>% filter(Pstatus == 'A') %>%
  select(guardian, health) %>%
  group_by(guardian) %>%
  summarise_all(mean)

plotMat <- ggplot(dataMat, aes(x = factor(guardian), y = health, fill = guardian )) + 
  geom_col() +
  labs( title = "Etat de santé en fonction du tuteur pour les familles séparées")

plotMat
```

Etat de santé en fonction du tuteur chez les familles non séparées

```{r}
dataMat <- dfMat %>% filter(Pstatus == 'T') %>%
  select(guardian, health) %>%
  group_by(guardian) %>%
  summarise_all(mean)

plotMat <- ggplot(dataMat, aes(x = factor(guardian), y = health, fill = guardian )) + 
  geom_col() +
  labs( title = "Etat de santé en fonction du tuteur pour les familles ensembles")

plotMat
```

