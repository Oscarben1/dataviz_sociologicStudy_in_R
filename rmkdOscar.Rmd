---
title: "RmrkdOscar"
author: "Oscar"
date: "23/04/2021"
output: html_document
---

Importons ici toutes les libraries utiles à notre projet
```{r message = FALSE}
library(readr)
library(ggplot2)
library(dplyr)
```


Importons dans un premier temps les datasets

```{r message = FALSE}
dfMaths <- read_csv("data/student-mat.csv")
dfMaths <- dfMaths %>% filter(age < 20)
head(dfMaths)
dfPortugais <- read_csv("data/student-por.csv")
dfPortugais <- dfPortugais %>% filter(age < 20)
head(dfPortugais)
```

Regardons l'influence du sexe sur les résultats à l'école, en maths et en portugais

----------------------------------------------------------

Tout d'abord, regardons les effectifs dans les différentes écoles pour avoir une vue d'ensemble

```{r message = FALSE}

ggplot(dfMaths, aes(x = school, fill = sex)) + 
  geom_bar(position = position_dodge(0.9), alpha = 0.6) + 
  scale_fill_brewer(palette = "Dark2") + 
  labs(fill = "Sexe", x = "Ecole", y = "Effectifs", title = "Part des effectifs Masculins et Féminins dans chaque école")
```

Regardons maintenant les effectifs par sexe selon les ages (entre 14 et 19 ans uniquement, les effectifs etant trop bas au dessus de cet age) pour comprendre un peu mieux la répartition des genres dans ces écoles, et dans ce dataset.

```{r message = FALSE}
#préparation des données
df <- dfMaths %>% filter(age < 20)

#Barplot 
ggplot(df, aes(x = age, fill = sex)) + 
    geom_bar(position = position_dodge(.9), alpha = 0.6) +
    scale_fill_brewer(palette = "Dark2") + 
    scale_x_continuous(breaks = seq(14, 19, 1)) +
    labs(fill = "Sexe", x = "Age", y = "Effectifs",title = "Part des effectifs Masculins et Féminins selon l'âge")
```

Regardons le nombre d'heures travaillées selon le genre

```{r message = FALSE}
#preparation des données
df <- dfMaths %>% select(sex, studytime)

#BoxPlot
ggplot(df, aes(x = sex, y = studytime)) + 
  geom_boxplot(aes(fill = sex),alpha = 0.6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Répartition des notes en fonction du genre")

```

On peut voir que les filles travaillent généralement plus que les garcons en maths dans notre dataset dfMaths. On peut alors se dire que le travail paye et qu'elles doivent obtenir de meilleurs résultats dans cette matière. Verifions le.

Regardons la note finale selon le genre, en mathématiques

```{r message = FALSE}
#preparation des données
df <- dfMaths %>% select(sex, G3)

#BoxPlot
ggplot(df, aes(x = sex, y = G3)) + 
  geom_boxplot(aes(fill = sex),alpha = .6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Répartition des notes en fonction du genre")
  

```

Le graph nous montre que la moyenne des notes des garcons en maths est plus élevée que celle des filles, ce qui est étonnant puisque ces derniers travaillent moins que les filles. On peut se dire qu'être un garcon est un avantage pour être l'élève modèle en maths.

Réalisons la même étude pour le portugais.

BoxPlot repartition du temps de travail selon le sexe en matiere de portugais

```{r message = FALSE}
#preparation des données
df <- dfPortugais %>% select(sex, studytime)

#BoxPlot
ggplot(df, aes(x = sex, y = studytime)) + 
  geom_boxplot(aes(fill = sex),alpha = .6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Temps de travail en portugais en fonction du genre")

```

Les hommes travaillent en effet moins que les femmes en moyenne, en portugais également, mais cet écart se réduit pour la matière de portugais. Regardons le résultat sur les notes.

```{r message = FALSE}
#preparation des données
df <- dfPortugais %>% select(sex, G3)

#BoxPlot
ggplot(df, aes(x = sex, y = G3)) + 
  geom_boxplot(aes(fill = sex),alpha = .6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Répartition des notes en fonction du genre")
  

```

Cette fois-ci, le travail paye ! Les filles ont en effet de meilleurs résultats en portugais que les garcons.

Peut être que les filles sortent plus que les garcons ?

```{r}
df <- dfMaths %>% select(goout, sex);

ggplot(df, aes(x= goout, fill =sex)) +
    geom_density(alpha = 0.6) + 
    scale_fill_brewer(palette = "Dark2") +
    xlab("Fréquence de sorties") +
    labs(title="répartition de la fréquence de sorties chez les persones en couple");
```

Finlement, la fréquence des sorties est sensiblement pareil entre les filles et les garcons.

-----------------------------------

INFLUENCE DE L'AGE

On regarde tout d'abord la répartition des ages dans le dataset dfMaths

```{r}
#preparation des donnees
df <- dfMaths %>% select(age)

ggplot(df, aes(x = age)) +
  geom_bar(fill = "lightblue", alpha = 0.7)
```

On voit que les élèves de 20, 21 et 22 ans sont négligeables, on ne les prendra sonc pas en compte dans notre analyse.

On regarde la répartition des notes selon les ages en mathématiques.

```{r message = FALSE}
#preparation des données 
df <- dfMaths

#BoxPlot
df$age=factor(df$age)
  ggplot(df, aes(x=age, y=G3, fill=age)) +
    geom_boxplot(alpha = 0.6)+
    labs(title="Repartition des notes finales G3 selon l'age",x="age", y = "Note finale") +
    scale_fill_brewer(palette = "Dark2") +
    stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white")  
```

On distingue que dans les ages bas (15,16 et 17), les notes sont sensiblement les mêmes, des variations opèrent dans les ages plus avancés notamment ceux de 20 ans qui obtiennent de bien meilleurs résultats en maths. Dans ce cas, avoir 20 ans est un avantage pour être l'élève modèle.

Regardons si la répartition est la même pour le portugais
```{r message = FALSE}
#preparation des données 
df <- dfPortugais

#BoxPlot
df$age=factor(df$age)
  ggplot(df, aes(x=age, y=G3, fill=age)) +
    geom_boxplot(alpha = 0.6)+
    labs(title="Repartition des notes finales G3 selon l'age",x="age", y = "Note finale") +
    scale_fill_brewer(palette = "Dark2") +
    stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white")  
```

On distingue toujours que dans les ages bas (15,16 et 17), les notes sont sensiblement les mêmes, cependant, les variations n'opèrent pas forcément comme pour les mathématiques, cette fois les moyennes des notes en portugais selon les ages sont sensiblement les mêmes.

```{r message = FALSE}
dfMaths$Fedu=factor(dfMaths$Fedu)
ggplot(dfMaths, aes(x = Fedu, y = G3)) + 
    geom_boxplot(aes(fill = Fedu),alpha = .6,size = 1) + 
    scale_fill_brewer(palette = "Dark2") + 
    stat_summary(fun.y = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
    labs(title = "Répartiton des notes en fonction de l'éduction du père", x = "Education du père", y = "notes") + 
    theme(axis.title.y=element_blank()) + theme(axis.title.x=element_blank())
```

