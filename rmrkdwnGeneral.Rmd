---
title: "RmrkdwnGeneral"
author: "Oscar"
date: "23/04/2021"
output: html_document
---

Importons ici toutes les libraries utiles à notre projet
```{r message = FALSE}
library(readr)
library(ggplot2)
library(dplyr)
library(scales)
```


Importons dans un premier temps les datasets

```{r message = FALSE}
dfMathsComplet <- read_csv("data/student-mat.csv")
dfMaths <- dfMathsComplet %>% filter(age < 20)

#ajout d'une colonne de moyenne des 3 notes :
temp <- dfMaths %>% select(G1,G2,G3)
temp <- as.data.frame(rowSums(temp)/3)
dfMaths <- cbind(dfMaths, temp) %>% rename('Gmean' = `rowSums(temp)/3`)

#Visualisation du dataset
head(dfMaths)

dfPortugaisComplet <- read_csv("data/student-por.csv")
dfPortugais <- dfPortugaisComplet %>% filter(age < 20)

#ajout d'une colonne de moyenne des 3 notes :
temp <- dfPortugais %>% select(G1,G2,G3)
temp <- as.data.frame(rowSums(temp)/3)
dfPortugais <- cbind(dfPortugais, temp) %>% rename('Gmean' = `rowSums(temp)/3`)
head(dfPortugais)
```

INTERNET EN FONCTION DES NOTES 

```{r message = FALSE}
#préparation des données
df <- dfMaths %>% group_by(internet) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(internet, mean_Gmean)

#Barplot 
ggplot(df, aes(x = internet, y = mean_Gmean)) + 
    geom_bar(stat = "identity") +
    scale_fill_brewer(palette = "Dark2") + 
    labs(x = "internet", y = "Gmean",title = "INTERNET EN FONCTION DES NOTES")
```

ADRESSE EN FONCTION DES NOTES

```{r message = FALSE}
#préparation des données
df <- dfMaths %>% group_by(address) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(address, mean_Gmean)

#Barplot 
ggplot(df, aes(x = address, y = mean_Gmean)) + 
    geom_bar(stat = "identity") +
    scale_fill_brewer(palette = "Dark2") + 
    labs(x = "Adresse", y = "Gmean",title = "Adresse en fonction de la moyenne des notes")
```

FATHER ET MOTHER JOB EN FONCTION DES NOTES

```{r message = FALSE}
#préparation des données
df <- dfMaths %>% group_by(Fjob) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(Fjob, mean_Gmean)

#Barplot 
ggplot(df, aes(x = Fjob, y = mean_Gmean)) + 
    geom_bar(stat = "identity") +
    scale_fill_brewer(palette = "Dark2") + 
    labs(x = "Job du père", y = "Gmean",title = "Job du père en fonction de la moyenne des notes")
```

```{r message = FALSE}
#préparation des données
df <- dfMaths %>% group_by(Mjob) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(Mjob, mean_Gmean)

#Barplot 
ggplot(df, aes(x = Mjob, y = mean_Gmean)) + 
    geom_bar(stat = "identity") +
    scale_fill_brewer(palette = "Dark2") + 
    labs(x = "Adress", y = "Gmean",title = "Part des effectifs Masculins et Féminins selon l'âge")
```

REPARTITION HOMME - FEMME DANS LES ECOLES

```{r message = FALSE}

ggplot(dfMaths, aes(x = school, fill = sex)) + 
  geom_bar(position = position_dodge(0.9), alpha = 0.6) + 
  scale_fill_brewer(palette = "Dark2") + 
  labs(fill = "Sexe", x = "Ecole", y = "Effectifs", title = "Part des effectifs Masculins et Féminins dans chaque école")
```

Regardons la MOYENNE selon le genre, en mathématiques --> garcon meilleurs en maths

```{r message = FALSE}
#preparation des données
df <- dfMaths %>% select(sex, Gmean)

#BoxPlot
ggplot(df, aes(x = sex, y = Gmean)) + 
  geom_boxplot(aes(fill = sex),alpha = .6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Répartition des notes en fonction du genre")
  
```

Regardons la MOYENNE selon le genre, en Portugais --> Filles meilleures en portugais

```{r message = FALSE}
#preparation des données
df <- dfPortugais %>% select(sex, Gmean)

#BoxPlot
ggplot(df, aes(x = sex, y = Gmean)) + 
  geom_boxplot(aes(fill = sex),alpha = .6,size = 1) + 
  stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white") +
  scale_fill_brewer(palette = "Dark2") +
  ggtitle("Répartition des notes en fonction du genre")
  

```

On regarde la repartition des ages --> On trie céar 20,21, 22 négligeable

```{r}
#preparation des donnees
df <- dfMathsComplet %>% select(age)

ggplot(df, aes(x = age)) +
  geom_bar(fill = "lightblue", alpha = 0.7) + 
  labs(title = "Repartiton des effectifs selon l'age", x = "age", y = "effectifs")
```

On regarde la répartition des notes selon les ages en mathématiques. --> ca baisse plus on est agé

```{r message = FALSE}
#preparation des données 
df <- dfMaths

#BoxPlot
df$age=factor(df$age)
  ggplot(df, aes(x=age, y=Gmean, fill=age)) +
    geom_boxplot(alpha = 0.6)+
    labs(title="Repartition des moyennes des notes selon l'age",x="age", y = "Note finale") +
    scale_fill_brewer(palette = "Dark2") +
    stat_summary(fun = "mean", geom = "point", shape= 21, size= 2, fill= "white")  
```

Le freetime est le même environ, quelque soit l'age. On peut se demander si avoir du temps libre signifie être moins impliqué dans ses études et donc avoir de moins bonnes notes, ou si, au contraire, se dégager du temps libre est synonyme d'organisation et donc de réussite scolaire : 

```{r message = FALSE}
df <- dfPortugais %>% group_by(freetime) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(freetime, mean_Gmean)

ggplot(df, aes(x = freetime, y = mean_Gmean)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = freetime)) +
    geom_line(color = "blue") +
    labs(title = "Temps libre en fonction des notes", x = "temps libre", y = "moyenne des notes", fill = "Temps libre") +
    scale_fill_continuous(labels = c("1 : très peu", "2 : modérément", "3 : suffisamment", "4 : beaucoup", "5 : blablabla"), type = "viridis")
  
```

Conso d'alcool le wknd en fonction des notes --> boire un peu c'est bien

```{r message = FALSE}
df <- dfPortugais %>% group_by(Walc) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(Walc, mean_Gmean)

ggplot(df, aes(x = Walc, y = mean_Gmean)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = Walc)) +
    geom_line(color = "blue") +
    labs(title = "Conso d'alcool le wknd en fonction des notes", x = "conso d'alcool le wknd", y = "moyenne des notes", fill = "conso d'alcool") +
    scale_fill_continuous(labels = c("1 : très peu", "2 : modérément", "3 : suffisamment", "4 : beaucoup", "5 : blablabla"), type = "viridis")
  
```

On peut voir que la consommation d'alcool a clairement un impact sur les notes et que ce sont ceux qui en consomment peu (niveau 2) qui ont les meilleures résultats. On peut donc considérer qu'il faut boire mais très peu, pour avoir les meilleurs notes (s'amuser le weekend pour relacher les cours par exemple).

Voyons maintenant si la consommation d'alcool la semaine a un gros impact : 

```{r message = FALSE}
df <- dfPortugais %>% group_by(Dalc) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(Dalc, mean_Gmean)

ggplot(df, aes(x = Dalc, y = mean_Gmean)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = Dalc)) +
    geom_line(color = "blue") +
    labs(title = "Conso d'alcool en semaine en fonction des notes", x = "Conso d'alcool en semaine", y = "moyenne des notes", fill = "conso d'alcool") +
    scale_fill_continuous(labels = c("1 : très peu", "2 : modérément", "3 : suffisamment", "4 : beaucoup", "5 : blablabla"), type = "viridis")
```

L'impact de la consommation d'alcool en semaine semble encore plus lourd, cette fois si, le niveau 1 de consommation (pas de consommation) est celui qui obtient les meilleures notes.

Voyons maintenant si le temps de travail implique des meilleurs notes, en maths :

```{r message = FALSE}
#preparation des données
df <- dfMaths %>% group_by(studytime) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(studytime, mean_Gmean)

ggplot(df, aes(x = studytime, y = mean_Gmean)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = studytime)) +
    geom_line(color = "blue") +
    labs(title = "Notes en fonction du temps de travail en Maths", x = "temps de travail", y = "moyenne des notes", fill = "Temps de travail") +
    scale_fill_continuous(labels = c("1 : très peu", "2 : modérément", "3 : suffisamment", "4 : beaucoup"), type = "viridis")

```

On voit que plus es élèves travaillent, meileures sont leurs notes, cependant, on voit que la différence n'est pas énorme (voire négligeable) entre 3h et 4h.

Voyons pour le portugais : 

```{r message = FALSE}
#preparation des données
df <- dfPortugais %>% group_by(studytime) %>% mutate(mean_Gmean = mean(Gmean)) %>% distinct(studytime, mean_Gmean)

ggplot(df, aes(x = studytime, y = mean_Gmean)) +
    geom_bar(stat = "identity", alpha = 0.7, aes(fill = studytime)) +
    geom_line(color = "blue") +
    labs(title = "Notes en fonction du temps de travail en Portugais", x = "temps de travail", y = "moyenne des notes", fill = "Temps de travail") +
    scale_fill_continuous(labels = c("1 : très peu", "2 : modérément", "3 : suffisamment", "4 : beaucoup"), type = "viridis")
    

```

Meme constat pour le portugais. On peut se dire que pour optimiser son temps, ne travailler que 3h et profiter de l'heure restant pour se détendre ou faire du sport est surement la bonne solution.
